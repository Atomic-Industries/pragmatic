SHELL = /bin/bash

CPPFLAGS = 
MAKE = make -s

PREFIX = @prefix@
include_dir = $(PREFIX)/include/pragmatic
lib_dir = $(PREFIX)/lib

LIB = lib/libpragmatic.a

default: lib

lib:
	@echo "  BUILD Fortran interface"
	@(cd src && $(MAKE))

doxygen:
	@echo "  DOXYGEN Doxyfile"
	@doxygen Doxyfile > doxygen.log

test: basic_test

basic_test:
	@echo "  TEST"
	@(cd tests && $(MAKE) test)

clean:
	@echo "  CLEAN docs"
	@rm -rf docs
	@echo "  CLEAN src"
	@(cd src && $(MAKE) clean)
	@echo "  CLEAN include"
	@(cd include && rm -rf *.mod)
	@echo "  CLEAN tests"
	@(cd tests && $(MAKE) clean)

distclean: clean
	@echo "   DISTCLEAN"
	@rm -rf config.status config.log Makefile src/Makefile tests/Makefile

install:
	mkdir -p $(DESTDIR)$(include_dir)
	cp -r include/* $(DESTDIR)$(include_dir)/
	mkdir -p $(DESTDIR)$(lib_dir)
	cp -r $(LIB) $(DESTDIR)$(lib_dir)/
