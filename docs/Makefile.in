SHELL = /bin/bash

MAKE = make -s

.SUFFIXES: .tex .pdf

.tex.pdf:
	rm -f $*.pdf
	pdflatex $<
	if fgrep "Rerun to" $*.log; then $(MAKE) --assume-new $< $@;fi
ifndef NOBIBTEX
	if fgrep "There were undefined"  $*.log;\
	then bibtex $*; \
	$(MAKE) NOBIBTEX=true --assume-new $< $@;fi
endif

# -------------------

default:
	@($(MAKE) manual)

manual: pragmatic.pdf

clean:
	rm -rf html
	rm -f pragmatic.pdf *.log *.aux *.bbl *.blg *.idx *.lof *.out *.toc tmp.inputs
