SHELL = /bin/bash

CXX = @CXX@
CPPFLAGS = @CPPFLAGS@ -I../eigen-2.0 -I../metric_tensor/include -I../include -I../smooth/include -I../functionals/include

CXXFLAGS = $(CPPFLAGS) @CXXFLAGS@ @OPENMP_CXXFLAGS@

LIBS = @LIBS@

TEST_SRC = $(wildcard src/*.cpp)
TEST_BIN = $(patsubst src/%.cpp,bin/%,$(TEST_SRC))

.SUFFIXES: .cpp .o

.cpp.o:
	$(CXX) $(CXXFLAGS) -c $<

default: test

test: $(TEST_BIN)
	python ./unittest bin

bin/%: src/%.cpp
	@echo "    CXX $@"
	@$(CXX) $(CXXFLAGS) -o $@ $< $(LIBS)

clean:
	rm -rf *.o $(TEST_BIN)
