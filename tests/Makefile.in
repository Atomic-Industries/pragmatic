SHELL = /bin/bash

CXX = @CXX@
CPPFLAGS = @CPPFLAGS@ -I../eigen-2.0 -I../include

CXXFLAGS = $(CPPFLAGS) @CXXFLAGS@ @OPENMP_CXXFLAGS@

LIBS = ticker.o @LIBS@

TEST_SRC = $(wildcard src/*.cpp)
TEST_BIN = $(patsubst src/%.cpp,bin/%,$(TEST_SRC))
VPATH = ./:./src

.SUFFIXES: .cpp .o

.cpp.o:
	$(CXX) $(CXXFLAGS) -c $<

default: test

test: ticker.o $(TEST_BIN)
	python ./unittest bin

binaries: ticker.o $(TEST_BIN)

bin/%: src/%.cpp 
	@echo "    CXX $@"
	@$(CXX) $(CXXFLAGS) -o $@ $< $(LIBS)

clean:
	rm -rf *.o $(TEST_BIN) bin/test*
